(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61776,e=>{"use strict";let t=(0,e.i(15315).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],61776)},10884,e=>{"use strict";let t=(0,e.i(15315).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],10884)},31247,(e,t,r)=>{t.exports=e.r(72473)},25938,e=>{"use strict";let t=(0,e.i(15315).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],25938)},43085,e=>{"use strict";let t,r,s,a,i=(e,t)=>t.some(t=>e instanceof t),n=new WeakMap,l=new WeakMap,c=new WeakMap,o={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return n.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return d(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,r)=>{let s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(d(e.result)),s()},i=()=>{r(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)}),c.set(t,e),t}if(l.has(e))return l.get(e);let t=function(e){if("function"==typeof e)return(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(u(this),t),d(this.request)}:function(...t){return d(e.apply(u(this),t))};return(e instanceof IDBTransaction&&function(e){if(n.has(e))return;let t=new Promise((t,r)=>{let s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),s()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});n.set(e,t)}(e),i(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,o):e}(e);return t!==e&&(l.set(e,t),c.set(t,e)),t}let u=e=>c.get(e),m=["get","getKey","getAll","getAllKeys","count"],x=["put","add","delete","clear"],p=new Map;function h(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(p.get(t))return p.get(t);let r=t.replace(/FromIndex$/,""),s=t!==r,a=x.includes(r);if(!(r in(s?IDBIndex:IDBObjectStore).prototype)||!(a||m.includes(r)))return;let i=async function(e,...t){let i=this.transaction(e,a?"readwrite":"readonly"),n=i.store;return s&&(n=n.index(t.shift())),(await Promise.all([n[r](...t),a&&i.done]))[0]};return p.set(t,i),i}o={...t=o,get:(e,r,s)=>h(e,r)||t.get(e,r,s),has:(e,r)=>!!h(e,r)||t.has(e,r)};let f=["continue","continuePrimaryKey","advance"],b={},g=new WeakMap,y=new WeakMap,w={get(e,t){if(!f.includes(t))return e[t];let r=b[t];return r||(r=b[t]=function(...e){g.set(this,y.get(this)[t](...e))}),r}};async function*v(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let r=new Proxy(t,w);for(y.set(r,t),c.set(r,u(t));t;)yield r,t=await (g.get(r)||t.continue()),g.delete(r)}function j(e,t){return t===Symbol.asyncIterator&&i(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&i(e,[IDBIndex,IDBObjectStore])}o={...r=o,get:(e,t,s)=>j(e,t)?v:r.get(e,t,s),has:(e,t)=>j(e,t)||r.has(e,t)};let N="tacit-data";class k{dbName;db=null;constructor(e){this.dbName=e}async getDb(){return this.db||(this.db=await function(e,t,{blocked:r,upgrade:s,blocking:a,terminated:i}={}){let n=indexedDB.open(e,1),l=d(n);return s&&n.addEventListener("upgradeneeded",e=>{s(d(n.result),e.oldVersion,e.newVersion,d(n.transaction),e)}),r&&n.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),l.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),l}(this.dbName,0,{upgrade(e){e.objectStoreNames.contains(N)||e.createObjectStore(N)}})),this.db}async get(e){let t=await this.getDb();return await t.get(N,e)??null}async set(e,t){let r=await this.getDb();await r.put(N,t,e)}async delete(e){let t=await this.getDb();return void 0!==await t.get(N,e)&&(await t.delete(N,e),!0)}async list(e){let t=await this.getDb();return(await t.getAllKeys(N)).filter(t=>t.startsWith(e))}async close(){this.db&&(this.db.close(),this.db=null)}}e.s(["IndexedDBBackend",()=>k],43085)},20407,e=>{"use strict";var t=e.i(73942),r=e.i(28787),s=e.i(31247),a=e.i(8013),i=e.i(43085);function n(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}async function l(){let e=await crypto.subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("raw",e.publicKey),r=await crypto.subtle.exportKey("pkcs8",e.privateKey),s=new Uint8Array(t),a=new Uint8Array(r),i=new Uint8Array([237,1]),l=new Uint8Array(i.length+s.length);return l.set(i),l.set(s,i.length),{did:`did:key:z${function(e){if(0===e.length)return"";let t=0;for(let r of e){if(0!==r)break;t++}let r=[0];for(let t of e){let e=t;for(let t=0;t<r.length;t++)e+=r[t]<<8,r[t]=e%58,e=e/58|0;for(;e>0;)r.push(e%58),e=e/58|0}let s="";for(let e=0;e<t;e++)s+="1";for(let e=r.length-1;e>=0;e--)s+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[r[e]];return s}(l)}`,publicKey:s,privateKey:a,publicKeyHex:n(s),created:new Date}}var c=e.i(74898),o=e.i(15315);let d=(0,o.default)("fingerprint-pattern",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);var u=e.i(61776),m=e.i(69553),x=e.i(10884);let p=(0,o.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var h=e.i(25938);function f(){let e=(0,s.useRouter)(),o=(0,a.createClient)(),[f,b]=(0,r.useState)("profile"),[g,y]=(0,r.useState)(null),[w,v]=(0,r.useState)(null),[j,N]=(0,r.useState)(10),[k,S]=(0,r.useState)([]),[C,D]=(0,r.useState)(""),[I,_]=(0,r.useState)(""),[B,M]=(0,r.useState)(""),[E,K]=(0,r.useState)(""),[A,L]=(0,r.useState)(null);async function T(){if(g&&C.trim()){b("minting"),L(null);try{let e=await l();v(e);let t=new i.IndexedDBBackend(`tacit-${g.id}`);await t.set("identity",JSON.stringify({did:e.did,publicKey:n(e.publicKey),privateKey:n(e.privateKey),publicKeyHex:e.publicKeyHex,created:e.created.toISOString()})),await t.close();let r=15*k.length,s=10*!!g.email,a=Math.min(10+r+s,100);N(a);let c="new";a>=80?c="exemplary":a>=60?c="trusted":a>=40?c="established":a>=20&&(c="emerging");let{error:d}=await o.from("profiles").upsert({id:g.id,did:e.did,public_key_hex:e.publicKeyHex,display_name:C.trim(),bio:I.trim()||null,avatar_url:g.user_metadata?.avatar_url||null,domain:"professional",seeking:B.trim()||null,offering:E.trim()||null,trust_score:a,trust_level:c,onboarding_complete:!0});if(d){console.error("Profile save error:",d),L("Failed to save profile. Please try again."),b("profile");return}for(let e of k){let{error:t}=await o.from("credentials").upsert({user_id:g.id,provider:e,provider_user_id:g.user_metadata?.sub||g.id,provider_email:g.email||null,provider_name:C,account_created_at:g.user_metadata?.created_at||null,credential_type:"PlatformVerification",credential_json:{type:"PlatformVerification",issuer:"did:tacit:service",claim:`Verified ${e} account`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"});t&&console.error(`Failed to save ${e} credential:`,t.message)}if(g.email&&!k.includes("email")){let{error:e}=await o.from("credentials").upsert({user_id:g.id,provider:"email",provider_user_id:g.id,provider_email:g.email,provider_name:C,credential_type:"EmailVerification",credential_json:{type:"EmailVerification",issuer:"did:tacit:service",claim:`Verified email: ${g.email}`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"});e&&console.error("Failed to save email credential:",e.message)}await new Promise(e=>setTimeout(e,2e3)),b("complete")}catch(e){console.error("Minting error:",e),L("Something went wrong during identity minting. Please try again."),b("profile")}}}return((0,r.useEffect)(()=>{!async function(){let{data:{user:t}}=await o.auth.getUser();if(!t)return e.replace("/login");let{data:r}=await o.from("profiles").select("onboarding_complete").eq("id",t.id).maybeSingle();if(r?.onboarding_complete)return e.replace("/dashboard");y(t);let s=[],a=t.app_metadata?.provider;a&&"email"!==a&&s.push(a),S(s),D(t.user_metadata?.full_name||t.user_metadata?.name||t.email?.split("@")[0]||"Tacit User"),N(Math.min(10+15*s.length+10*!!t.email,100))}()},[e,o]),g)?(0,t.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center px-6",children:(0,t.jsxs)("div",{className:"w-full max-w-lg",children:[(0,t.jsx)("div",{className:"flex items-center justify-center gap-2 mb-10",children:["profile","minting","complete"].map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${f===e?"bg-accent text-white":["profile","minting","complete"].indexOf(f)>r?"bg-success text-white":"bg-bg-card text-text-muted border border-border"}`,children:["profile","minting","complete"].indexOf(f)>r?(0,t.jsx)(u.CheckCircle2,{className:"w-4 h-4"}):r+1}),r<2&&(0,t.jsx)("div",{className:"w-12 h-0.5 bg-border"})]},e))}),"profile"===f&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)(c.Shield,{className:"w-12 h-12 text-accent mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Set up your identity"}),(0,t.jsx)("p",{className:"text-text-muted",children:"Tell the network who you are. This will be visible to other verified members."})]}),A&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-danger/10 border border-danger/30 rounded-xl text-sm text-danger flex items-start gap-2",children:[(0,t.jsx)(h.AlertCircle,{className:"w-4 h-4 mt-0.5 shrink-0"}),A]}),(0,t.jsxs)("div",{className:"bg-bg-card border border-border rounded-xl p-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-text-muted",children:"Starting Trust Score"}),(0,t.jsx)("span",{className:"text-xl font-bold text-accent",children:j})]}),(0,t.jsx)("div",{className:"h-2 bg-bg rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-accent rounded-full transition-all duration-500",style:{width:`${j}%`}})}),(0,t.jsx)("p",{className:"text-xs text-text-muted mt-2",children:k.length>0?`Signed in via ${k[0]} (+15 points). Connect more accounts later to boost your score.`:"Signed in via email (+10 points). Connect Google or GitHub in settings to boost your score."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,t.jsx)(u.CheckCircle2,{className:"w-3 h-3"}),g.email]}),k.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,t.jsx)(u.CheckCircle2,{className:"w-3 h-3"}),e]},e))]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Display Name *"}),(0,t.jsx)("input",{type:"text",value:C,onChange:e=>D(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"How others will see you"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Bio"}),(0,t.jsx)("textarea",{value:I,onChange:e=>_(e.target.value),rows:2,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent resize-none",placeholder:"What are you working on?"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Seeking"}),(0,t.jsx)("input",{type:"text",value:B,onChange:e=>M(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Co-founder, funding..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Offering"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>K(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Engineering, design..."})]})]}),(0,t.jsxs)("button",{onClick:T,disabled:!C.trim(),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright disabled:opacity-50 disabled:cursor-not-allowed text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Mint My Identity",(0,t.jsx)(d,{className:"w-5 h-5"})]})]}),"minting"===f&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[(0,t.jsx)(d,{className:"w-24 h-24 text-accent animate-pulse"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(m.Loader2,{className:"w-8 h-8 text-accent-bright animate-spin"})})]}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Minting your identity..."}),(0,t.jsxs)("p",{className:"text-text-muted mb-4",children:["Generating Ed25519 key pair on your device.",(0,t.jsx)("br",{}),"Your private key never leaves this browser."]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-text-muted",children:[(0,t.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(u.CheckCircle2,{className:"w-4 h-4 text-success"}),"Key pair generated"]}),(0,t.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(m.Loader2,{className:"w-4 h-4 animate-spin"}),"Creating W3C DID..."]})]})]}),"complete"===f&&w&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p,{className:"w-12 h-12 text-warning mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Identity minted!"}),(0,t.jsx)("p",{className:"text-text-muted mb-8",children:"Welcome to the TACIT network. Your cryptographic identity is ready."}),(0,t.jsxs)("div",{className:"bg-bg-card border border-accent/30 rounded-2xl p-6 mb-8 text-left",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Shield,{className:"w-5 h-5 text-accent"}),(0,t.jsx)("span",{className:"text-sm font-medium text-accent",children:"TACIT Identity"})]}),(0,t.jsx)("span",{className:"text-2xl font-bold",children:j})]}),(0,t.jsx)("h3",{className:"text-xl font-semibold mb-1",children:C}),I&&(0,t.jsx)("p",{className:"text-text-muted text-sm mb-3",children:I}),(0,t.jsxs)("div",{className:"bg-bg rounded-lg p-3 mb-3",children:[(0,t.jsx)("p",{className:"text-xs text-text-muted mb-1",children:"DID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:w.did})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,t.jsx)(u.CheckCircle2,{className:"w-3 h-3"}),"email"]}),k.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,t.jsx)(u.CheckCircle2,{className:"w-3 h-3"}),e]},e))]})]}),(0,t.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Enter the Network",(0,t.jsx)(x.ArrowRight,{className:"w-5 h-5"})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center",children:(0,t.jsx)(m.Loader2,{className:"w-8 h-8 text-accent animate-spin"})})}e.s(["default",()=>f],20407)}]);