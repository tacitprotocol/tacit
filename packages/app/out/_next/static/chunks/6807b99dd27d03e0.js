(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61776,e=>{"use strict";let t=(0,e.i(15315).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],61776)},31247,(e,t,s)=>{t.exports=e.r(72473)},10884,e=>{"use strict";let t=(0,e.i(15315).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],10884)},43085,e=>{"use strict";let t,s,r,a,i=(e,t)=>t.some(t=>e instanceof t),n=new WeakMap,l=new WeakMap,c=new WeakMap,d={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return n.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return o(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function o(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,s)=>{let r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(o(e.result)),r()},i=()=>{s(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}),c.set(t,e),t}if(l.has(e))return l.get(e);let t=function(e){if("function"==typeof e)return(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(m(this),t),o(this.request)}:function(...t){return o(e.apply(m(this),t))};return(e instanceof IDBTransaction&&function(e){if(n.has(e))return;let t=new Promise((t,s)=>{let r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});n.set(e,t)}(e),i(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,d):e}(e);return t!==e&&(l.set(e,t),c.set(t,e)),t}let m=e=>c.get(e),u=["get","getKey","getAll","getAllKeys","count"],x=["put","add","delete","clear"],h=new Map;function p(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(h.get(t))return h.get(t);let s=t.replace(/FromIndex$/,""),r=t!==s,a=x.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!(a||u.includes(s)))return;let i=async function(e,...t){let i=this.transaction(e,a?"readwrite":"readonly"),n=i.store;return r&&(n=n.index(t.shift())),(await Promise.all([n[s](...t),a&&i.done]))[0]};return h.set(t,i),i}d={...t=d,get:(e,s,r)=>p(e,s)||t.get(e,s,r),has:(e,s)=>!!p(e,s)||t.has(e,s)};let f=["continue","continuePrimaryKey","advance"],g={},b=new WeakMap,y=new WeakMap,j={get(e,t){if(!f.includes(t))return e[t];let s=g[t];return s||(s=g[t]=function(...e){b.set(this,y.get(this)[t](...e))}),s}};async function*w(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let s=new Proxy(t,j);for(y.set(s,t),c.set(s,m(t));t;)yield s,t=await (b.get(s)||t.continue()),b.delete(s)}function v(e,t){return t===Symbol.asyncIterator&&i(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&i(e,[IDBIndex,IDBObjectStore])}d={...s=d,get:(e,t,r)=>v(e,t)?w:s.get(e,t,r),has:(e,t)=>v(e,t)||s.has(e,t)};let N="tacit-data";class k{dbName;db=null;constructor(e){this.dbName=e}async getDb(){return this.db||(this.db=await function(e,t,{blocked:s,upgrade:r,blocking:a,terminated:i}={}){let n=indexedDB.open(e,1),l=o(n);return r&&n.addEventListener("upgradeneeded",e=>{r(o(n.result),e.oldVersion,e.newVersion,o(n.transaction),e)}),s&&n.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),l.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),l}(this.dbName,0,{upgrade(e){e.objectStoreNames.contains(N)||e.createObjectStore(N)}})),this.db}async get(e){let t=await this.getDb();return await t.get(N,e)??null}async set(e,t){let s=await this.getDb();await s.put(N,t,e)}async delete(e){let t=await this.getDb();return void 0!==await t.get(N,e)&&(await t.delete(N,e),!0)}async list(e){let t=await this.getDb();return(await t.getAllKeys(N)).filter(t=>t.startsWith(e))}async close(){this.db&&(this.db.close(),this.db=null)}}e.s(["IndexedDBBackend",()=>k],43085)},25938,e=>{"use strict";let t=(0,e.i(15315).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],25938)},20407,e=>{"use strict";var t=e.i(73942),s=e.i(28787),r=e.i(31247),a=e.i(8013),i=e.i(43085);function n(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}async function l(){let e=await crypto.subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("raw",e.publicKey),s=await crypto.subtle.exportKey("pkcs8",e.privateKey),r=new Uint8Array(t),a=new Uint8Array(s),i=new Uint8Array([237,1]),l=new Uint8Array(i.length+r.length);return l.set(i),l.set(r,i.length),{did:`did:key:z${function(e){if(0===e.length)return"";let t=0;for(let s of e){if(0!==s)break;t++}let s=[0];for(let t of e){let e=t;for(let t=0;t<s.length;t++)e+=s[t]<<8,s[t]=e%58,e=e/58|0;for(;e>0;)s.push(e%58),e=e/58|0}let r="";for(let e=0;e<t;e++)r+="1";for(let e=s.length-1;e>=0;e--)r+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[s[e]];return r}(l)}`,publicKey:r,privateKey:a,publicKeyHex:n(r),created:new Date}}var c=e.i(74898),d=e.i(15315);let o=(0,d.default)("fingerprint-pattern",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);var m=e.i(61776),u=e.i(69553),x=e.i(10884);let h=(0,d.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);var p=e.i(25938);function f(){let e=(0,r.useRouter)(),d=(0,a.createClient)(),[f,g]=(0,s.useState)("profile"),[b,y]=(0,s.useState)(null),[j,w]=(0,s.useState)(null),[v,N]=(0,s.useState)(10),[k,S]=(0,s.useState)([]),[C,D]=(0,s.useState)(""),[I,_]=(0,s.useState)(""),[B,M]=(0,s.useState)(""),[E,K]=(0,s.useState)(""),[L,A]=(0,s.useState)(null);async function T(){if(b&&C.trim()){g("minting"),A(null);try{let e=await l();w(e);let t=new i.IndexedDBBackend(`tacit-${b.id}`);await t.set("identity",JSON.stringify({did:e.did,publicKey:n(e.publicKey),privateKey:n(e.privateKey),publicKeyHex:e.publicKeyHex,created:e.created.toISOString()})),await t.close();let s=15*k.length,r=10*!!b.email,a=Math.min(10+s+r,100);N(a);let c="new";a>=80?c="exemplary":a>=60?c="trusted":a>=40?c="established":a>=20&&(c="emerging");let{error:o}=await d.from("profiles").upsert({id:b.id,did:e.did,public_key_hex:e.publicKeyHex,display_name:C.trim(),bio:I.trim()||null,avatar_url:b.user_metadata?.avatar_url||null,domain:"professional",seeking:B.trim()||null,offering:E.trim()||null,trust_score:a,trust_level:c,onboarding_complete:!0});if(o){console.error("Profile save error:",o),A("Failed to save profile. Please try again."),g("profile");return}for(let e of k){let{error:t}=await d.from("credentials").upsert({user_id:b.id,provider:e,provider_user_id:b.user_metadata?.sub||b.id,provider_email:b.email||null,provider_name:C,account_created_at:b.user_metadata?.created_at||null,credential_type:"PlatformVerification",credential_json:{type:"PlatformVerification",issuer:"did:tacit:service",claim:`Verified ${e} account`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"});t&&console.error(`Failed to save ${e} credential:`,t.message)}if(b.email&&!k.includes("email")){let{error:e}=await d.from("credentials").upsert({user_id:b.id,provider:"email",provider_user_id:b.id,provider_email:b.email,provider_name:C,credential_type:"EmailVerification",credential_json:{type:"EmailVerification",issuer:"did:tacit:service",claim:`Verified email: ${b.email}`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"});e&&console.error("Failed to save email credential:",e.message)}await new Promise(e=>setTimeout(e,2e3)),g("complete")}catch(e){console.error("Minting error:",e),A("Something went wrong during identity minting. Please try again."),g("profile")}}}return((0,s.useEffect)(()=>{!async function(){let{data:{user:t}}=await d.auth.getUser();if(!t)return e.replace("/login");let{data:s}=await d.from("profiles").select("onboarding_complete").eq("id",t.id).maybeSingle();if(s?.onboarding_complete)return e.replace("/dashboard");y(t);let r=[],a=t.app_metadata?.provider;a&&"email"!==a&&r.push(a),S(r),D(t.user_metadata?.full_name||t.user_metadata?.name||t.email?.split("@")[0]||"Tacit User"),N(Math.min(10+15*r.length+10*!!t.email,100))}()},[e,d]),b)?(0,t.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center px-6",children:(0,t.jsxs)("div",{className:"w-full max-w-lg",children:[(0,t.jsx)("div",{className:"flex items-center justify-center gap-2 mb-10",children:["profile","minting","complete"].map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${f===e?"bg-accent text-white":["profile","minting","complete"].indexOf(f)>s?"bg-success text-white":"bg-bg-card text-text-muted border border-border"}`,children:["profile","minting","complete"].indexOf(f)>s?(0,t.jsx)(m.CheckCircle2,{className:"w-4 h-4"}):s+1}),s<2&&(0,t.jsx)("div",{className:"w-12 h-0.5 bg-border"})]},e))}),"profile"===f&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)(c.Shield,{className:"w-12 h-12 text-accent mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Set up your identity"}),(0,t.jsx)("p",{className:"text-text-muted",children:"Tell the network who you are. This will be visible to other verified members."})]}),L&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-danger/10 border border-danger/30 rounded-xl text-sm text-danger flex items-start gap-2",children:[(0,t.jsx)(p.AlertCircle,{className:"w-4 h-4 mt-0.5 shrink-0"}),L]}),(0,t.jsxs)("div",{className:"bg-bg-card border border-border rounded-xl p-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-text-muted",children:"Starting Trust Score"}),(0,t.jsx)("span",{className:"text-xl font-bold text-accent",children:v})]}),(0,t.jsx)("div",{className:"h-2 bg-bg rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-accent rounded-full transition-all duration-500",style:{width:`${v}%`}})}),(0,t.jsx)("p",{className:"text-xs text-text-muted mt-2",children:k.length>0?`Signed in via ${k[0]} (+15 points). Connect more accounts later to boost your score.`:"Signed in via email (+10 points). Connect Google or GitHub in settings to boost your score."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-3 h-3"}),b.email]}),k.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-3 h-3"}),e]},e))]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Display Name *"}),(0,t.jsxs)("span",{className:`text-[10px] ${C.length>50?"text-danger":"text-text-muted"}`,children:[C.length,"/50"]})]}),(0,t.jsx)("input",{type:"text",value:C,onChange:e=>D(e.target.value.slice(0,50)),maxLength:50,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"How others will see you"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Bio"}),(0,t.jsxs)("span",{className:`text-[10px] ${I.length>500?"text-danger":"text-text-muted"}`,children:[I.length,"/500"]})]}),(0,t.jsx)("textarea",{value:I,onChange:e=>_(e.target.value.slice(0,500)),maxLength:500,rows:2,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent resize-none",placeholder:"What are you working on?"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Seeking"}),(0,t.jsxs)("span",{className:`text-[10px] ${B.length>200?"text-danger":"text-text-muted"}`,children:[B.length,"/200"]})]}),(0,t.jsx)("input",{type:"text",value:B,onChange:e=>M(e.target.value.slice(0,200)),maxLength:200,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Co-founder, funding..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Offering"}),(0,t.jsxs)("span",{className:`text-[10px] ${E.length>200?"text-danger":"text-text-muted"}`,children:[E.length,"/200"]})]}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>K(e.target.value.slice(0,200)),maxLength:200,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Engineering, design..."})]})]}),(0,t.jsxs)("button",{onClick:T,disabled:!C.trim(),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright disabled:opacity-50 disabled:cursor-not-allowed text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Mint My Identity",(0,t.jsx)(o,{className:"w-5 h-5"})]})]}),"minting"===f&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[(0,t.jsx)(o,{className:"w-24 h-24 text-accent animate-pulse"}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsx)(u.Loader2,{className:"w-8 h-8 text-accent-bright animate-spin"})})]}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Minting your identity..."}),(0,t.jsxs)("p",{className:"text-text-muted mb-4",children:["Generating Ed25519 key pair on your device.",(0,t.jsx)("br",{}),"Your private key never leaves this browser."]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-text-muted",children:[(0,t.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-4 h-4 text-success"}),"Key pair generated"]}),(0,t.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(u.Loader2,{className:"w-4 h-4 animate-spin"}),"Creating W3C DID..."]})]})]}),"complete"===f&&j&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(h,{className:"w-12 h-12 text-warning mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Identity minted!"}),(0,t.jsx)("p",{className:"text-text-muted mb-8",children:"Welcome to the TACIT network. Your cryptographic identity is ready."}),(0,t.jsxs)("div",{className:"bg-bg-card border border-accent/30 rounded-2xl p-6 mb-8 text-left",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Shield,{className:"w-5 h-5 text-accent"}),(0,t.jsx)("span",{className:"text-sm font-medium text-accent",children:"TACIT Identity"})]}),(0,t.jsx)("span",{className:"text-2xl font-bold",children:v})]}),(0,t.jsx)("h3",{className:"text-xl font-semibold mb-1",children:C}),I&&(0,t.jsx)("p",{className:"text-text-muted text-sm mb-3",children:I}),(0,t.jsxs)("div",{className:"bg-bg rounded-lg p-3 mb-3",children:[(0,t.jsx)("p",{className:"text-xs text-text-muted mb-1",children:"DID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:j.did})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-3 h-3"}),"email"]}),k.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,t.jsx)(m.CheckCircle2,{className:"w-3 h-3"}),e]},e))]})]}),(0,t.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Enter the Network",(0,t.jsx)(x.ArrowRight,{className:"w-5 h-5"})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center",children:(0,t.jsx)(u.Loader2,{className:"w-8 h-8 text-accent animate-spin"})})}e.s(["default",()=>f],20407)}]);