(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69973,e=>{"use strict";let t=(0,e.i(15315).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>t],69973)},43085,e=>{"use strict";let t,r,a,s,n=(e,t)=>t.some(t=>e instanceof t),i=new WeakMap,o=new WeakMap,d=new WeakMap,l={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return c(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function c(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,r)=>{let a=()=>{e.removeEventListener("success",s),e.removeEventListener("error",n)},s=()=>{t(c(e.result)),a()},n=()=>{r(e.error),a()};e.addEventListener("success",s),e.addEventListener("error",n)}),d.set(t,e),t}if(o.has(e))return o.get(e);let t=function(e){if("function"==typeof e)return(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(u(this),t),c(this.request)}:function(...t){return c(e.apply(u(this),t))};return(e instanceof IDBTransaction&&function(e){if(i.has(e))return;let t=new Promise((t,r)=>{let a=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",n),e.removeEventListener("abort",n)},s=()=>{t(),a()},n=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",s),e.addEventListener("error",n),e.addEventListener("abort",n)});i.set(e,t)}(e),n(e,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,l):e}(e);return t!==e&&(o.set(e,t),d.set(t,e)),t}let u=e=>d.get(e),m=["get","getKey","getAll","getAllKeys","count"],x=["put","add","delete","clear"],h=new Map;function b(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(h.get(t))return h.get(t);let r=t.replace(/FromIndex$/,""),a=t!==r,s=x.includes(r);if(!(r in(a?IDBIndex:IDBObjectStore).prototype)||!(s||m.includes(r)))return;let n=async function(e,...t){let n=this.transaction(e,s?"readwrite":"readonly"),i=n.store;return a&&(i=i.index(t.shift())),(await Promise.all([i[r](...t),s&&n.done]))[0]};return h.set(t,n),n}l={...t=l,get:(e,r,a)=>b(e,r)||t.get(e,r,a),has:(e,r)=>!!b(e,r)||t.has(e,r)};let p=["continue","continuePrimaryKey","advance"],g={},f=new WeakMap,y=new WeakMap,v={get(e,t){if(!p.includes(t))return e[t];let r=g[t];return r||(r=g[t]=function(...e){f.set(this,y.get(this)[t](...e))}),r}};async function*w(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let r=new Proxy(t,v);for(y.set(r,t),d.set(r,u(t));t;)yield r,t=await (f.get(r)||t.continue()),f.delete(r)}function j(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}l={...r=l,get:(e,t,a)=>j(e,t)?w:r.get(e,t,a),has:(e,t)=>j(e,t)||r.has(e,t)};let D="tacit-data";class N{dbName;db=null;constructor(e){this.dbName=e}async getDb(){return this.db||(this.db=await function(e,t,{blocked:r,upgrade:a,blocking:s,terminated:n}={}){let i=indexedDB.open(e,1),o=c(i);return a&&i.addEventListener("upgradeneeded",e=>{a(c(i.result),e.oldVersion,e.newVersion,c(i.transaction),e)}),r&&i.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{n&&e.addEventListener("close",()=>n()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}(this.dbName,0,{upgrade(e){e.objectStoreNames.contains(D)||e.createObjectStore(D)}})),this.db}async get(e){let t=await this.getDb();return await t.get(D,e)??null}async set(e,t){let r=await this.getDb();await r.put(D,t,e)}async delete(e){let t=await this.getDb();return void 0!==await t.get(D,e)&&(await t.delete(D,e),!0)}async list(e){let t=await this.getDb();return(await t.getAllKeys(D)).filter(t=>t.startsWith(e))}async close(){this.db&&(this.db.close(),this.db=null)}}e.s(["IndexedDBBackend",()=>N],43085)},64460,e=>{"use strict";var t=e.i(73942),r=e.i(28787),a=e.i(8013),s=e.i(36209),n=e.i(74898),i=e.i(15315);let o=(0,i.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),d=(0,i.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var l=e.i(69973),c=e.i(69553),u=e.i(43085);function m(){let e=(0,a.createClient)(),[i,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[b,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),[y,v]=(0,r.useState)(!1),[w,j]=(0,r.useState)(null);async function D(){if("DELETE"===g){v(!0),j(null);try{let{data:{user:t}}=await e.auth.getUser();if(!t)return;for(let r of(await Promise.all([e.from("credentials").delete().eq("user_id",t.id),e.from("engagement_requests").delete().eq("user_id",t.id),e.from("engagement_requests").delete().eq("target_id",t.id),e.from("agent_profiles").delete().eq("user_id",t.id),e.from("profiles").delete().eq("id",t.id)]),["tacit-identity","tacit-keys"]))try{let e=new u.IndexedDBBackend(r);await e.close(),indexedDB.deleteDatabase(r)}catch(e){console.warn(`Failed to delete IndexedDB "${r}":`,e)}await e.auth.signOut(),window.location.href="/"}catch(e){console.error("Failed to delete account:",e),j("Failed to delete account. Please try again."),v(!1)}}}return(0,r.useEffect)(()=>{!async function(){let{data:{user:t}}=await e.auth.getUser();if(t&&m(t.email||""),t){let{data:r}=await e.from("profiles").select("did").eq("id",t.id).single();r&&h(r.did)}}()},[e]),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-1",children:"Settings"}),(0,t.jsx)("p",{className:"text-text-muted mb-8",children:"Manage your account and security preferences"}),(0,t.jsxs)("div",{className:"max-w-2xl space-y-6",children:[(0,t.jsxs)("div",{className:"bg-bg-card border border-border rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(s.Settings,{className:"w-5 h-5 text-accent"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Account"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-text-muted",children:"Email"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:i})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-text-muted",children:"DID"}),(0,t.jsx)("p",{className:"text-xs font-mono break-all",children:x})]})]})]}),(0,t.jsxs)("div",{className:"bg-bg-card border border-border rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(o,{className:"w-5 h-5 text-warning"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Security"})]}),(0,t.jsx)("p",{className:"text-sm text-text-muted mb-3",children:"Your private key is stored in this browser's IndexedDB. It never leaves your device. If you clear browser data, you will need to re-mint your identity."}),(0,t.jsx)("div",{className:"p-3 bg-warning/5 border border-warning/20 rounded-xl",children:(0,t.jsx)("p",{className:"text-xs text-warning",children:"Key backup and recovery is coming in a future update. For now, your identity is tied to this browser. Do not clear site data."})})]}),(0,t.jsxs)("div",{className:"bg-bg-card border border-border rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(n.Shield,{className:"w-5 h-5 text-accent"}),(0,t.jsx)("h3",{className:"font-semibold",children:"TACIT Protocol"})]}),(0,t.jsx)("div",{className:"space-y-2",children:[{label:"Protocol Website",href:"https://tacitprotocol.com"},{label:"GitHub",href:"https://github.com/tacitprotocol"},{label:"Documentation",href:"https://github.com/tacitprotocol/tacit"},{label:"X / Twitter",href:"https://x.com/tacitprotocol"}].map(({label:e,href:r})=>(0,t.jsxs)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-2 rounded-lg hover:bg-bg-elevated transition-colors text-sm",children:[e,(0,t.jsx)(l.ExternalLink,{className:"w-3.5 h-3.5 text-text-muted"})]},e))})]}),(0,t.jsxs)("div",{className:"bg-bg-card border border-danger/30 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(d,{className:"w-5 h-5 text-danger"}),(0,t.jsx)("h3",{className:"font-semibold text-danger",children:"Danger Zone"})]}),(0,t.jsx)("p",{className:"text-sm text-text-muted mb-4",children:"Deleting your account will permanently remove your profile, credentials, and all associated data. Your DID will be revoked."}),w&&(0,t.jsx)("div",{className:"mb-3 p-3 bg-danger/10 border border-danger/30 rounded-xl text-sm text-danger",children:w}),b?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-sm text-danger font-medium",children:"Type DELETE to confirm account deletion:"}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>f(e.target.value),placeholder:"Type DELETE",className:"w-full bg-bg border border-danger/30 rounded-xl px-4 py-2.5 text-text text-sm focus:outline-none focus:border-danger"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:D,disabled:"DELETE"!==g||y,className:"flex items-center gap-2 text-sm bg-danger hover:bg-danger/90 disabled:opacity-50 text-white px-4 py-2 rounded-xl transition-colors",children:[y&&(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}),y?"Deleting...":"Permanently Delete"]}),(0,t.jsx)("button",{onClick:()=>{p(!1),f("")},className:"text-sm text-text-muted hover:text-text px-4 py-2 rounded-xl transition-colors",children:"Cancel"})]})]}):(0,t.jsx)("button",{onClick:()=>p(!0),className:"text-sm text-danger border border-danger/30 hover:bg-danger/10 px-4 py-2 rounded-xl transition-colors",children:"Delete Account"})]})]})]})}e.s(["default",()=>m],64460)}]);