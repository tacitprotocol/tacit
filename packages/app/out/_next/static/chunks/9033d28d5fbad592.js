(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15315,e=>{"use strict";var t=e.i(28787);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:l="",children:c,iconNode:o,...d},u)=>(0,t.createElement)("svg",{ref:u,...a,width:s,height:s,stroke:e,strokeWidth:n?24*Number(i)/Number(s):i,className:r("lucide",l),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(d)&&{"aria-hidden":"true"},...d},[...o.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(c)?c:[c]])),n=(e,a)=>{let n=(0,t.forwardRef)(({className:n,...l},c)=>(0,t.createElement)(i,{ref:c,iconNode:a,className:r(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...l}));return n.displayName=s(e),n};e.s(["default",()=>n],15315)},69553,e=>{"use strict";let t=(0,e.i(15315).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],69553)},61776,e=>{"use strict";let t=(0,e.i(15315).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],61776)},31247,(e,t,r)=>{t.exports=e.r(72473)},10884,e=>{"use strict";let t=(0,e.i(15315).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["ArrowRight",()=>t],10884)},20407,e=>{"use strict";let t,r,s,a;var i=e.i(73942),n=e.i(28787),l=e.i(31247),c=e.i(8013);let o=(e,t)=>t.some(t=>e instanceof t),d=new WeakMap,u=new WeakMap,m=new WeakMap,x={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return h(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){if(e instanceof IDBRequest){let t;return t=new Promise((t,r)=>{let s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(h(e.result)),s()},i=()=>{r(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)}),m.set(t,e),t}if(u.has(e))return u.get(e);let s=function(e){if("function"==typeof e)return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),h(this.request)}:function(...t){return h(e.apply(p(this),t))};return(e instanceof IDBTransaction&&function(e){if(d.has(e))return;let t=new Promise((t,r)=>{let s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),s()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});d.set(e,t)}(e),o(e,t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,x):e}(e);return s!==e&&(u.set(e,s),m.set(s,e)),s}let p=e=>m.get(e),f=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],g=new Map;function y(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(g.get(t))return g.get(t);let r=t.replace(/FromIndex$/,""),s=t!==r,a=b.includes(r);if(!(r in(s?IDBIndex:IDBObjectStore).prototype)||!(a||f.includes(r)))return;let i=async function(e,...t){let i=this.transaction(e,a?"readwrite":"readonly"),n=i.store;return s&&(n=n.index(t.shift())),(await Promise.all([n[r](...t),a&&i.done]))[0]};return g.set(t,i),i}x={...s=x,get:(e,t,r)=>y(e,t)||s.get(e,t,r),has:(e,t)=>!!y(e,t)||s.has(e,t)};let w=["continue","continuePrimaryKey","advance"],v={},j=new WeakMap,N=new WeakMap,k={get(e,t){if(!w.includes(t))return e[t];let r=v[t];return r||(r=v[t]=function(...e){j.set(this,N.get(this)[t](...e))}),r}};async function*C(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let r=new Proxy(t,k);for(N.set(r,t),m.set(r,p(t));t;)yield r,t=await (j.get(r)||t.continue()),j.delete(r)}function S(e,t){return t===Symbol.asyncIterator&&o(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&o(e,[IDBIndex,IDBObjectStore])}x={...a=x,get:(e,t,r)=>S(e,t)?C:a.get(e,t,r),has:(e,t)=>S(e,t)||a.has(e,t)};let D="tacit-data";class I{dbName;db=null;constructor(e){this.dbName=e}async getDb(){return this.db||(this.db=await function(e,t,{blocked:r,upgrade:s,blocking:a,terminated:i}={}){let n=indexedDB.open(e,1),l=h(n);return s&&n.addEventListener("upgradeneeded",e=>{s(h(n.result),e.oldVersion,e.newVersion,h(n.transaction),e)}),r&&n.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),l.then(e=>{i&&e.addEventListener("close",()=>i()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),l}(this.dbName,0,{upgrade(e){e.objectStoreNames.contains(D)||e.createObjectStore(D)}})),this.db}async get(e){let t=await this.getDb();return await t.get(D,e)??null}async set(e,t){let r=await this.getDb();await r.put(D,t,e)}async delete(e){let t=await this.getDb();return void 0!==await t.get(D,e)&&(await t.delete(D,e),!0)}async list(e){let t=await this.getDb();return(await t.getAllKeys(D)).filter(t=>t.startsWith(e))}async close(){this.db&&(this.db.close(),this.db=null)}}function _(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}async function E(){let e=await crypto.subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),t=await crypto.subtle.exportKey("raw",e.publicKey),r=await crypto.subtle.exportKey("pkcs8",e.privateKey),s=new Uint8Array(t),a=new Uint8Array(r),i=new Uint8Array([237,1]),n=new Uint8Array(i.length+s.length);return n.set(i),n.set(s,i.length),{did:`did:key:z${function(e){if(0===e.length)return"";let t=0;for(let r of e){if(0!==r)break;t++}let r=[0];for(let t of e){let e=t;for(let t=0;t<r.length;t++)e+=r[t]<<8,r[t]=e%58,e=e/58|0;for(;e>0;)r.push(e%58),e=e/58|0}let s="";for(let e=0;e<t;e++)s+="1";for(let e=r.length-1;e>=0;e--)s+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[r[e]];return s}(n)}`,publicKey:s,privateKey:a,publicKeyHex:_(s),created:new Date}}var M=e.i(74898),B=e.i(15315);let L=(0,B.default)("fingerprint-pattern",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);var A=e.i(61776),K=e.i(69553),O=e.i(10884);let T=(0,B.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),P=(0,B.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function V(){let e=(0,l.useRouter)(),t=(0,c.createClient)(),[r,s]=(0,n.useState)("profile"),[a,o]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[m,x]=(0,n.useState)(10),[h,p]=(0,n.useState)([]),[f,b]=(0,n.useState)(""),[g,y]=(0,n.useState)(""),[w,v]=(0,n.useState)(""),[j,N]=(0,n.useState)(""),[k,C]=(0,n.useState)(null);async function S(){if(a&&f.trim()){s("minting"),C(null);try{let e=await E();u(e);let r=new I(`tacit-${a.id}`);await r.set("identity",JSON.stringify({did:e.did,publicKey:_(e.publicKey),privateKey:_(e.privateKey),publicKeyHex:e.publicKeyHex,created:e.created.toISOString()})),await r.close();let i=15*h.length,n=10*!!a.email,l=Math.min(10+i+n,100);x(l);let c="new";l>=80?c="exemplary":l>=60?c="trusted":l>=40?c="established":l>=20&&(c="emerging");let{error:o}=await t.from("profiles").upsert({id:a.id,did:e.did,public_key_hex:e.publicKeyHex,display_name:f.trim(),bio:g.trim()||null,avatar_url:a.user_metadata?.avatar_url||null,domain:"professional",seeking:w.trim()||null,offering:j.trim()||null,trust_score:l,trust_level:c,onboarding_complete:!0});if(o){console.error("Profile save error:",o),C("Failed to save profile. Please try again."),s("profile");return}for(let e of h)await t.from("credentials").upsert({user_id:a.id,provider:e,provider_user_id:a.user_metadata?.sub||a.id,provider_email:a.email||null,provider_name:f,account_created_at:a.user_metadata?.created_at||null,credential_type:"PlatformVerification",credential_json:{type:"PlatformVerification",issuer:"did:tacit:service",claim:`Verified ${e} account`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"});a.email&&!h.includes("email")&&await t.from("credentials").upsert({user_id:a.id,provider:"email",provider_user_id:a.id,provider_email:a.email,provider_name:f,credential_type:"EmailVerification",credential_json:{type:"EmailVerification",issuer:"did:tacit:service",claim:`Verified email: ${a.email}`,issued:new Date().toISOString()},verified_at:new Date().toISOString()},{onConflict:"user_id, provider"}),await new Promise(e=>setTimeout(e,2e3)),s("complete")}catch(e){console.error("Minting error:",e),C("Something went wrong during identity minting. Please try again."),s("profile")}}}return((0,n.useEffect)(()=>{!async function(){let{data:{user:r}}=await t.auth.getUser();if(!r)return e.replace("/login");o(r);let s=[],a=r.app_metadata?.provider;a&&"email"!==a&&s.push(a),p(s),b(r.user_metadata?.full_name||r.user_metadata?.name||r.email?.split("@")[0]||"Tacit User"),x(Math.min(10+15*s.length,100))}()},[e,t]),a)?(0,i.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center px-6",children:(0,i.jsxs)("div",{className:"w-full max-w-lg",children:[(0,i.jsx)("div",{className:"flex items-center justify-center gap-2 mb-10",children:["profile","minting","complete"].map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${r===e?"bg-accent text-white":["profile","minting","complete"].indexOf(r)>t?"bg-success text-white":"bg-bg-card text-text-muted border border-border"}`,children:["profile","minting","complete"].indexOf(r)>t?(0,i.jsx)(A.CheckCircle2,{className:"w-4 h-4"}):t+1}),t<2&&(0,i.jsx)("div",{className:"w-12 h-0.5 bg-border"})]},e))}),"profile"===r&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)(M.Shield,{className:"w-12 h-12 text-accent mx-auto mb-4"}),(0,i.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Set up your identity"}),(0,i.jsx)("p",{className:"text-text-muted",children:"Tell the network who you are. This will be visible to other verified members."})]}),k&&(0,i.jsxs)("div",{className:"mb-4 p-3 bg-danger/10 border border-danger/30 rounded-xl text-sm text-danger flex items-start gap-2",children:[(0,i.jsx)(P,{className:"w-4 h-4 mt-0.5 shrink-0"}),k]}),(0,i.jsxs)("div",{className:"bg-bg-card border border-border rounded-xl p-4 mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-sm text-text-muted",children:"Starting Trust Score"}),(0,i.jsx)("span",{className:"text-xl font-bold text-accent",children:m})]}),(0,i.jsx)("div",{className:"h-2 bg-bg rounded-full overflow-hidden",children:(0,i.jsx)("div",{className:"h-full bg-accent rounded-full transition-all duration-500",style:{width:`${m}%`}})}),(0,i.jsx)("p",{className:"text-xs text-text-muted mt-2",children:h.length>0?`Signed in via ${h[0]} (+15 points). Connect more accounts later to boost your score.`:"Signed in via email (+10 points). Connect Google or GitHub in settings to boost your score."})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,i.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,i.jsx)(A.CheckCircle2,{className:"w-3 h-3"}),a.email]}),h.map(e=>(0,i.jsxs)("span",{className:"inline-flex items-center gap-1.5 text-xs bg-success/10 text-success px-2.5 py-1 rounded-full",children:[(0,i.jsx)(A.CheckCircle2,{className:"w-3 h-3"}),e]},e))]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Display Name *"}),(0,i.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"How others will see you"})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Bio"}),(0,i.jsx)("textarea",{value:g,onChange:e=>y(e.target.value),rows:2,className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent resize-none",placeholder:"What are you working on?"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Seeking"}),(0,i.jsx)("input",{type:"text",value:w,onChange:e=>v(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Co-founder, funding..."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Offering"}),(0,i.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value),className:"w-full bg-bg-card border border-border rounded-xl px-4 py-3 text-text focus:outline-none focus:border-accent",placeholder:"Engineering, design..."})]})]}),(0,i.jsxs)("button",{onClick:S,disabled:!f.trim(),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright disabled:opacity-50 disabled:cursor-not-allowed text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Mint My Identity",(0,i.jsx)(L,{className:"w-5 h-5"})]})]}),"minting"===r&&(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[(0,i.jsx)(L,{className:"w-24 h-24 text-accent animate-pulse"}),(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,i.jsx)(K.Loader2,{className:"w-8 h-8 text-accent-bright animate-spin"})})]}),(0,i.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Minting your identity..."}),(0,i.jsxs)("p",{className:"text-text-muted mb-4",children:["Generating Ed25519 key pair on your device.",(0,i.jsx)("br",{}),"Your private key never leaves this browser."]}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-text-muted",children:[(0,i.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(A.CheckCircle2,{className:"w-4 h-4 text-success"}),"Key pair generated"]}),(0,i.jsxs)("p",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(K.Loader2,{className:"w-4 h-4 animate-spin"}),"Creating W3C DID..."]})]})]}),"complete"===r&&d&&(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(T,{className:"w-12 h-12 text-warning mx-auto mb-4"}),(0,i.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Identity minted!"}),(0,i.jsx)("p",{className:"text-text-muted mb-8",children:"Welcome to the TACIT network. Your cryptographic identity is ready."}),(0,i.jsxs)("div",{className:"bg-bg-card border border-accent/30 rounded-2xl p-6 mb-8 text-left",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(M.Shield,{className:"w-5 h-5 text-accent"}),(0,i.jsx)("span",{className:"text-sm font-medium text-accent",children:"TACIT Identity"})]}),(0,i.jsx)("span",{className:"text-2xl font-bold",children:m})]}),(0,i.jsx)("h3",{className:"text-xl font-semibold mb-1",children:f}),g&&(0,i.jsx)("p",{className:"text-text-muted text-sm mb-3",children:g}),(0,i.jsxs)("div",{className:"bg-bg rounded-lg p-3 mb-3",children:[(0,i.jsx)("p",{className:"text-xs text-text-muted mb-1",children:"DID"}),(0,i.jsx)("p",{className:"text-xs font-mono break-all",children:d.did})]}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,i.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,i.jsx)(A.CheckCircle2,{className:"w-3 h-3"}),"email"]}),h.map(e=>(0,i.jsxs)("span",{className:"inline-flex items-center gap-1 text-xs bg-success/10 text-success px-2 py-1 rounded-full",children:[(0,i.jsx)(A.CheckCircle2,{className:"w-3 h-3"}),e]},e))]})]}),(0,i.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex items-center justify-center gap-2 bg-accent hover:bg-accent-bright text-white px-5 py-3.5 rounded-xl font-medium transition-colors",children:["Enter the Network",(0,i.jsx)(O.ArrowRight,{className:"w-5 h-5"})]})]})]})}):(0,i.jsx)("div",{className:"min-h-screen bg-bg flex items-center justify-center",children:(0,i.jsx)(K.Loader2,{className:"w-8 h-8 text-accent animate-spin"})})}e.s(["default",()=>V],20407)}]);